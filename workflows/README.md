# Teisec Agent Workflow Capabilities

## Overview

Teisec Agent is designed to automate and streamline various security operations by leveraging custom workflows. These workflows integrate multiple plugins and capabilities to perform complex tasks such as email investigation, user activity monitoring, and threat intelligence analysis.

## Available Workflows

### Email Investigation Workflow

**Shortcut:** `/email`

**Description:** This workflow investigates emails by retrieving details from Microsoft Sentinel, analyzing the content and headers, and investigating associated domains and IP addresses for threat intelligence indicators.

**Input Parameters:**
- `sender_email_address`: The email address of the sender to be investigated.
- `subject_keyword`: A keyword from the email subject to filter the emails.

**Steps:**
1. **Obtain Email Details**
   - **Plugin:** SentinelKQLPlugin
   - **Capability:** generateandrunkql
   - **Description:** Retrieve email details from Microsoft Sentinel using the sender email address and subject keyword.

2. **Extract Email Data**
   - **Plugin:** GraphAPIPlugin
   - **Capability:** getemaildetails
   - **Description:** Retrieve the body and headers of the email listed in the previous step.

3. **Analyze Email Content**
   - **Plugin:** GPTPlugin
   - **Capability:** runprompt
   - **Description:** Analyze the content of the email for suspicious links, attachments, and keywords.

4. **Analyze Email Headers**
   - **Plugin:** GPTPlugin
   - **Capability:** runprompt
   - **Description:** Analyze the headers of the email for suspicious email authentication details and extract the list of IP addresses and domains related to the email.

5. **Investigate Associated Domains**
   - **Plugin:** SentinelKQLPlugin
   - **Capability:** InvestigateDomainListThreatIntelligence
   - **Description:** Investigate the domains extracted from the email headers for any threat intelligence indicators.

6. **Investigate Associated IP Addresses**
   - **Plugin:** SentinelKQLPlugin
   - **Capability:** InvestigateIPListThreatIntelligence
   - **Description:** Investigate the IP addresses extracted from the email headers for any threat intelligence indicators.

7. **Generate Investigation Report**
   - **Plugin:** GPTPlugin
   - **Capability:** runprompt
   - **Description:** Generate a detailed report of the findings from the email investigation.

## How to Use

1. **Run a Workflow:**
   - Use the shortcut command followed by the required input parameters. For example:
     ```
     /email sender_email_address=example@example.com subject_keyword=urgent
     ```

2. **Monitor Progress:**
   - The system will provide updates on the progress of each step in the workflow.

3. **Review Results:**
   - Once the workflow is complete, review the detailed report generated by the system.

## Custom Workflows

You can create custom workflows by defining new JSON files in the `workflows` folder. Each workflow should include the following sections:
- **Title:** The title of the workflow.
- **Shortcut:** A unique shortcut command to trigger the workflow.
- **Input Parameters:** A list of input parameters required for the workflow.
- **Steps:** A sequence of steps to be executed, each specifying the plugin, capability, and prompt text.

For more details on creating custom workflows, refer to the existing workflow JSON files in the `workflows` folder.

## Conclusion

Teisec Agent workflows provide a powerful way to automate and enhance your security operations. By leveraging the capabilities of various plugins, you can perform complex investigations and analyses with ease.
